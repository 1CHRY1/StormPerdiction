import{a as S}from"./initMap-BiXK8HwB.js";import{g as v,r,v as y,c as p,h as g,o as x,b as _,d as b,x as w,e as f,f as I,y as k,F as D}from"./index-l0_1r5o4.js";import{g as R,a as d,i as V,d as m,b as C}from"./api-Miiz4aSa.js";import"./stationInfo-DixEZJLI.js";import"./getStation-DC6WyyE7.js";const E=v({__name:"WaterGraph",setup(h){const l=r(!1);let e=null;const o=r(),n=y(),u=p(()=>R(n.currentStationID)),a=r(null),t=p(()=>a.value===null||a.value.hpre.length!==0);return g(n,async()=>{a.value=await d(n.currentStationID),console.log(l.value),e&&(e.clear(),m(e,a.value,u.value,t.value,l.value||!1))}),x(async()=>{a.value=await d(n.currentStationID),e=V(o),t.value&&m(e,a.value,u.value,t.value,l.value||!1)}),(i,s)=>(_(),b("div",{ref_key:"echartsRef",ref:o,class:"h-full w-full bg-white"},null,512))}}),W=v({__name:"WaterMapView",setup(h){const l=y(),e=r(null),o=r(!1),n=r(0),u=r(0);return x(async()=>{const a=await S(e.value,{center:[120.55,32.08],zoom:6.5});C(a),a.on("click",t=>{const i=[[t.point.x-3,t.point.y-3],[t.point.x+3,t.point.y+3]];if(a.getLayer("stations")){const s=a.queryRenderedFeatures(i,{layers:["stations"]});if(s&&s[0]){const c=s[0].properties.id;l.currentStationID=c,w.push("/real-time-situation/data")}}}),a.on("mousemove","stations",t=>{const i=[[t.point.x-3,t.point.y-3],[t.point.x+3,t.point.y+3]];if(a.getLayer("stations")){const s=a.queryRenderedFeatures(i,{layers:["stations"]});if(s&&s[0]){const c=s[0].properties.id;l.currentStationID=c,o.value=!0,n.value=t.point.x,u.value=t.point.y}}}),a.on("mouseleave","stations",()=>{o.value=!1})}),(a,t)=>(_(),b(D,null,[f("div",{ref_key:"mapContainerRef",ref:e,class:"map-container h-full w-full"},null,512),f("div",{class:"absolute w-[500px] h-[400px] bg-white bg-opacity-70 p-2 rounded border border-black",style:k({zIndex:o.value?"10":"-10",top:`${u.value-450}px`,left:`${n.value-350}px`})},[I(E,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=i=>o.value=i),class:"bg-blue-300 bg-opacity-30 backdrop-blur"},null,8,["modelValue"])],4)],64))}});export{W as default};
