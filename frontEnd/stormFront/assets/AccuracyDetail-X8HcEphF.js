import{g as T,z as N,r as f,v as M,c as y,h as U,o as $,b as x,d as w,e as o,f as i,i as h,t as _,u as D,l as m,F as j,n as z,k as C,p as F,q as P,s as R,_ as q}from"./index-l0_1r5o4.js";import{s as S}from"./stationInfo-DixEZJLI.js";import{i as G,d as k,g as H}from"./util-CAuFIMv1.js";import"./getStation-DC6WyyE7.js";const I=t=>{const a=Math.floor(t),s=Math.floor((t-a)*60);return a+"° "+s+"'"},A=t=>{const a=S[t];return{name:a.name,pinyin:a.pinyin,time:new Date(Date.now()).toLocaleString().replace(/:\d\d$/,""),lon:I(a.coord[0]),lat:I(a.coord[1]),type:a.type}},V=async t=>{const a=`/api/v1/data/level/station/yubao/48?station=${S[t].pinyin}`,s=await fetch(a).then(n=>n.json()).then(n=>n.data);if(!s)return{time:[],hpre:[],hadd:[],hyubao:[]};const e=`/api/v1/data/level/station/shice/48?station=${S[t].pinyin}`,c=await fetch(e).then(n=>n.json()).then(n=>n.data);if(!c)return{time:[],hpre:[],hadd:[],hyubao:[]};const d=s.time,g=c.hshice||[],l=s.hybresult||[],u=c.hshice.map((n,v)=>n-l[v]),r=[];for(let n=0;n<49;n++){const v=new Date(new Date(d).getTime()+n*60*60*1e3);r.push(v.toLocaleString().replace(/:\d\d$/,""))}return console.log(r),{time:r,hyubao:l,hpre:g,hadd:u}},B=async()=>{const t=await fetch("/api/v1/data/nc/txt").then(e=>e.json()).then(e=>e.data),a=[];if(t.length===0)return a;const s=t[0].length;for(let e=1;e<s;e++){const c={name:t[0][e],"平均误差(m)":t[1][e],"均方根误差(m)":t[2][e],"潮位合格率(%)":t[3][e]};a.push(c)}return a},O=T({__name:"AccuracyGraph",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(t){const a=N(t,"modelValue");let s=null;const e=f(),c=M(),d=y(()=>A(c.currentStationID)),g=f(null),l=f(null),u=y(()=>l.value===null||l.value.hpre.length!==0);return U(c,async()=>{l.value=await V(c.currentStationID),console.log(a.value),s&&(s.clear(),k(s,l.value,d.value,u.value,a.value||!1))}),$(async()=>{l.value=await V(c.currentStationID),s=G(e),g.value=await B(),u.value&&k(s,l.value,d.value,u.value,a.value||!1)}),(r,n)=>(x(),w("div",{ref_key:"echartsRef",ref:e,class:"h-full w-full bg-white"},null,512))}}),b=t=>(P("data-v-a4a3b368"),t=t(),R(),t),J={class:"h-full w-full flex bg-slate-300"},K={class:"flex-auto"},Q={class:"text-xl font-semibold text-[#406abf]"},W={class:"flex flex-col w-[20rem] bg-white"},X={class:"h-52 m-2 border border-zinc-300"},Y=b(()=>o("div",{class:"h-10 leading-10 px-2 bg-[#1b6ec8] text-white"},"站点详情",-1)),Z={class:"mx-3 my-2 flex flex-col"},ee={class:"my-1 text-lg"},te=b(()=>o("span",{class:"inline-block pr-2"},"站点名称:",-1)),ae={class:"inline-block pr-3"},oe={class:"my-1"},se=b(()=>o("span",{class:"inline-block pr-2 text-lg"},"站点类型:",-1)),ne={class:"inline-block pr-3"},le={class:"my-1"},ce=b(()=>o("span",{class:"inline-block pr-2 text-lg"},"站点位置:",-1)),ie={class:"inline-block pr-3"},re={class:"my-1"},ue=b(()=>o("span",{class:"inline-block pr-2 text-lg"},"当前时间:",-1)),de={class:"inline-block pr-3"},pe={class:"flex flex-col flex-auto m-2 top-1 border border-zinc-300"},_e=b(()=>o("div",{class:"h-10 leading-10 px-2 bg-[#1b6ec8] text-white"},"站点选择",-1)),he=T({__name:"AccuracyDetail",setup(t){const a=f("graph"),s=M(),e=y(()=>A(s.currentStationID)),c=f([]),d=f(null);return $(async()=>{d.value=await B(),c.value=await H()}),(g,l)=>{const u=m("el-tab-pane"),r=m("el-table-column"),n=m("el-table"),v=m("el-tabs"),E=m("el-radio"),L=m("el-radio-group");return x(),w("div",J,[o("div",K,[i(v,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=p=>a.value=p),type:"border-card",class:"bg-white h-full"},{default:h(()=>[i(u,{label:"折线图",name:"graph",class:"h-[86vh]"},{default:h(()=>[i(O)]),_:1}),i(u,{label:"数据表",name:"table",class:"flex flex-col items-center"},{default:h(()=>[o("div",Q,_(`${e.value.time.split(" ")[0]} 精度统计表`),1),i(n,{data:d.value,class:"h-[84vh]","highlight-current-row":!0},{default:h(()=>[i(r,{prop:"name",label:"站点",align:"center"}),i(r,{prop:"平均误差(m)",label:"平均误差(m)",align:"center"}),i(r,{prop:"均方根误差(m)",label:"均方根误差(m)",align:"center"}),i(r,{prop:"潮位合格率(%)",label:"潮位合格率(%)",align:"center"})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])]),o("div",W,[o("div",X,[Y,o("div",Z,[o("div",ee,[te,o("span",ae,_(e.value.name),1)]),o("div",oe,[se,o("span",ne,_(e.value.type==="sea"?"沿海":"沿江"),1)]),o("div",le,[ce,o("span",ie,_(e.value.lon),1),o("span",null,_(e.value.lat),1)]),o("div",re,[ue,o("span",de,_(e.value.time),1)])])]),o("div",pe,[_e,i(L,{modelValue:D(s).currentStationID,"onUpdate:modelValue":l[1]||(l[1]=p=>D(s).currentStationID=p),class:"py-2 px-4 block overflow-auto h-[66vh]"},{default:h(()=>[(x(!0),w(j,null,z(c.value,p=>(x(),C(E,{key:p.id,label:p.id,class:"block"},{default:h(()=>[F(_(p.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])])])}}}),ge=q(he,[["__scopeId","data-v-a4a3b368"]]);export{ge as default};
